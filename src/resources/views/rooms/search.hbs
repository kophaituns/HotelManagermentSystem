 <div class="container mt-5">
    <h2>Tìm kiếm phòng</h2>
    {{#if error}}
      <div class="alert alert-danger">{{error}}</div>
    {{/if}}
    <form action="/search" method="GET" class="mb-4">
      <div class="row">
        <div class="col-md-3">
          <label for="checkin" class="form-label">Ngày nhận phòng</label>
          <input type="date" name="checkin" id="checkin" class="form-control" value="{{checkin}}" required>
        </div>
        <div class="col-md-3">
          <label for="checkout" class="form-label">Ngày trả phòng</label>
          <input type="date" name="checkout" id="checkout" class="form-control" value="{{checkout}}" required>
        </div>
        <div class="col-md-2">
          <label for="roomCount" class="form-label">Số phòng</label>
          <input type="number" name="roomCount" id="roomCount" class="form-control" min="1" value="{{roomCount}}" required>
        </div>
        <div class="col-md-2">
          <label for="adults" class="form-label">Số người lớn</label>
          <input type="number" name="adults" id="adults" class="form-control" min="1" value="{{adults}}" required>
        </div>
        <div class="col-md-2">
          <label for="children" class="form-label">Số trẻ em</label>
          <input type="number" name="children" id="children" class="form-control" min="0" value="{{children}}">
        </div>
        <div class="col-md-3 mt-3">
          <label for="typeId" class="form-label">Loại phòng</label>
          <select name="typeId" id="typeId" class="form-control">
            <option value="">Tất cả</option>
            {{#each roomTypes}}
              <option value="{{_id}}" {{#if (eq ../selectedTypeId _id)}}selected{{/if}}>{{name}}</option>
            {{/each}}
          </select>
        </div>
      </div>
      <button type="submit" class="btn btn-primary mt-3">Tìm kiếm</button>
    </form>

    {{#if rooms.length}}
      <h3>Kết quả tìm kiếm</h3>
      <div class="row">
        {{#each rooms}}
          <div class="col-md-4 mb-4">
            <div class="card">
              {{#if images.length}}
                <img src="{{images.[0]}}" class="card-img-top room-card-img" alt="Ảnh phòng {{number}}">
              {{else}}
                <img src="/images/default-room.jpg" class="card-img-top room-card-img" alt="Ảnh phòng mặc định">
              {{/if}}
              <div class="card-body">
                <h5 class="card-title"><strong>Phòng: </strong>{{number}} ({{typeId.name}})</h5>
                <p class="card-text"><strong>Giá:</strong> {{price}} VND/đêm</p>
                {{#if description}}
                  <p class="card-text"><strong>Mô tả:</strong> {{description}}</p>
                {{/if}}
                {{#if area}}
                  <p class="card-text"><strong>Diện tích:</strong> {{area}} m²</p>
                {{/if}}
                {{#if capacity}}
                  <p class="card-text"><strong>Số khách tối đa:</strong> {{capacity}} người</p>
                {{/if}}
                <p class="card-text"><strong>Tiện nghi:</strong></p>
                <ul class="amenities-list">
                  {{#if amenities.wifi}}
                    <li>WiFi miễn phí</li>
                  {{/if}}
                  {{#if amenities.tv}}
                    <li>TV màn hình phẳng</li>
                  {{/if}}
                  {{#if amenities.airConditioner}}
                    <li>Máy lạnh</li>
                  {{/if}}
                  {{#if amenities.minibar}}
                    <li>Minibar</li>
                  {{/if}}
                  {{#if amenities.bathroom.length}}
                    {{#each amenities.bathroom}}
                      <li>{{this}}</li>
                    {{/each}}
                  {{/if}}
                </ul>
                <a href="/book/{{_id}}?checkin={{../checkin}}&checkout={{../checkout}}&roomCount={{../roomCount}}&adults={{../adults}}&children={{../children}}" class="btn btn-primary">Đặt phòng</a>
                <a href="/search/{{_id}}/availability?startDate={{../checkin}}&endDate={{../checkout}}" class="btn btn-info mt-2">Xem lịch trống</a>
              </div>
            </div>
          </div>
        {{/each}}
      </div>
    {{else}}
      <p>Không tìm thấy phòng trống trong khoảng thời gian này.</p>
    {{/if}}
  </div>